{include file="public/header" /}
<link rel="stylesheet" href="__STATIC__/amazeUi/assets/css/rome.css">
<link rel="stylesheet" href="__STATIC__/amazeUi/assets/css/example.css">
</head>
<body data-type="generalComponents">
{include file="public/nav_header"/}
<div class="tpl-page-container tpl-page-header-fixed">
    {include file="public/nav_left"/}
    <div class="tpl-content-wrapper">
        <div class="tpl-portlet-components">
            <div class="portlet-title am-lg-text-center">
                <div class="caption font-green bold am-lg-text-center">
                    <span class="am-icon-edit"></span> 修改
                </div>
                <a class="am-align-right" style="color: #838b8b" onClick="javascript:history.back(-1);"><div class="am-icon-close"></div></a>


            </div>

            <div class="tpl-block">

                <div class="am-g">
                    <div class="tpl-form-body tpl-form-line">{foreach name="datas" item="vo"}
                        <form class="am-form tpl-form-line-form">

                            <!--<div class="am-form-group">-->
                                <!--<label for="user-name" class="am-u-sm-3 am-form-label">标题 <span class="tpl-form-line-small-title">Title</span></label>-->
                                <!--<div class="am-u-sm-9">-->
                                    <!--<input type="text" class="tpl-form-input" id="user-title" value="">-->
                                    <!--<small>请填写标题文字10-20字左右。</small>-->
                                <!--</div>-->
                            <!--</div>-->
                            <div class="am-form-group">
                                <label for="user-name" class="am-u-sm-3 am-form-label">作者ID <span class="tpl-form-line-small-title">Author</span></label>
                                <div class="am-u-sm-9">
                                    <input type="text" class="tpl-form-input" id="user-author" value="{$vo.user_id}">
                                    <small>请输入作者ID。</small>
                                </div>
                            </div>
                            <div class="am-form-group">
                                <label for="user-email" class="am-u-sm-3 am-form-label">发布时间 <span class="tpl-form-line-small-title">Time</span></label>
                                <div class="am-u-sm-9">
                                    <input type="text" class="am-form-field tpl-form-no-bg" id='input' placeholder="发布时间" value="{$vo.time}"/>
                                    <small>发布时间为必填</small>
                                </div>
                            </div>



                            <!--<div class="am-form-group">-->
                                <!--<label for="user-weibo" class="am-u-sm-3 am-form-label">封面图 <span class="tpl-form-line-small-title">Images</span></label>-->
                                <!--<div class="am-u-sm-9">-->
                                    <!--<div class="am-form-group am-form-file">-->
                                        <!--<div class="tpl-form-file-img">-->
                                            <!--<img src="__STATIC/amazeUi/assets/img/a5.png" alt="">-->
                                        <!--</div>-->
                                        <!--<button type="button" class="am-btn am-btn-danger am-btn-sm">-->
                                            <!--<i class="am-icon-cloud-upload"></i> 添加封面图片</button>-->
                                        <!--<input id="doc-form-file" type="file" multiple>-->
                                    <!--</div>-->

                                <!--</div>-->
                            <!--</div>-->

                            <div class="am-form-group">
                                <label for="user-weibo" class="am-u-sm-3 am-form-label">点赞数 <span class="tpl-form-line-small-title">Count</span></label>
                                <div class="am-u-sm-9">
                                    <input type="text" id="user-category" placeholder="点赞数" value="{$vo.likecount}">
                                    <div>

                                    </div>
                                </div>
                            </div>


                            <div class="am-form-group">
                                <label for="user-intro" class="am-u-sm-3 am-form-label">文章内容</label>
                                <div class="am-u-sm-9">
                                    <textarea class="" rows="10" id="user-content" placeholder="请输入文章内容">{$vo.content}</textarea>
                                </div>
                            </div>

                            <div class="am-form-group">
                                <div class="am-u-sm-9 am-u-sm-push-3">
                                    <button type="button" id="submit" class="am-btn am-btn-primary tpl-btn-bg-color-success ">提交</button>
                                </div>
                            </div>
                        </form>{/foreach}
                    </div>
                </div>
            </div>


        </div>
    </div>

</div>
{include file="public/footer" /}
<script type="text/javascript" src="__STATIC__/amazeUi/assets/js/rome.js"></script>
<script type="text/javascript">
    rome(input);
    document.getElementById('submit').addEventListener('click', function () {
        //文章标题
        //var article_title =  $('#user-title').val();
        //发布时间
        var time = $('#input').val();
        //分类
        var likecount = $('#user-category').val();
        //作者
        var author = $('#user-author').val();
        //封面图
        //var headImgSrc =  $('#headImg')[0].src;
        // 读取没处理的内容
        var content = $('#user-content').val();
        // var undealContent = editor.txt.html();
        //处理后的文章详情
        // var dealContent =  undealContent.replace(/<br>/g,"").replace(/<p>/g,"").replace(/<p style[^>]*>/g,"").replace(/<\/p>/g,"%&%").replace(/<span style[^>]*>/g,"").replace(/<\/span>/g,"").replace(/<img src="/g,'').replace(/" style[^>]*">/g,'%&%').replace(/&nbsp;/g,' ');


        // if (article_title ==''){
        //     layer.msg('文章标题不能为空哦');
        //     return false;
        // }

        if (time ==''){
            layer.msg('时间不能为空哦');
            return false;
        }
        if(likecount==''){
            layer.msg('点赞数不能为空哦');
            return false;
        }
        if(content==''){
            layer.msg('文章内容不能为空哦');
            return false;
        }

        if (author ==''){
            layer.msg('作者ID不能为空哦');
            return false;
        }

        //提交文章
        var url = "{:url('news/newsedit',['id'=>$vo.id])}";
        var artdata = {
            content :content,
            time:time,
            likecount:likecount,
            author:author
        };
        $.post(url,artdata,function (res) {
            if (res.data==1){
                layer.alert(res.mes,{
                    title:'编辑评论',
                    btn:['确定'],
                    btnAlign:'c',
                    closeBtn:0,
                    yes:function(){
                    window.location.href="{:url('news/news')}";
                }
                })
            } else{
                layer.alert(res.mes,{
                    title:'编辑评论',
                    btn:['确定'],
                    btnAlign:'c',
                    closeBtn:0,
                    yes:function(){
                        window.history.back(-1);
                    }
                })
            }
        })

    }, false);

</script>
</body>

</html>