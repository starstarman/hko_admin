
{include file="public/header" /}
</head>
<body data-type="generalComponents">

{include file="public/nav_header"/}

<div class="tpl-page-container tpl-page-header-fixed">
    {include file="public/nav_left"/}

    <div class="tpl-content-wrapper">
        <div class="tpl-portlet-components">
            <div class="portlet-title">
                <div class="caption font-green bold">
                    <span class="am-icon-code"></span> {$Tab}
                </div>
                <div class="tpl-portlet-input tpl-fz-ml">
                    <div class="portlet-input input-small input-inline">
                        <div class="input-icon right">
                            <i id="selectIcon" class="am-icon-search"></i>
                            <input type="text" id="select" class="form-control form-control-solid" placeholder="请输入用户id"> </div>
                    </div>
                </div>


            </div>
            <div class="tpl-block">

                <div class="am-g">
                    <div class="am-u-sm-12">
                        <form class="am-form">
                            <table class="am-table am-table-striped am-table-hover table-main">
                                <thead>
                                <tr>
                                    <th class="table-check"><input type="checkbox" class="tpl-table-fz-check"></th>
                                    <th class="table-id">ID</th>
                                    <th class="table-title">用户昵称</th>
                                    <th class="table-sex">性别</th>
                                    <th class="table-author am-hide-sm-only">注册时间</th>
                                    <th class="table-set">设置密码</th>
                                    <th class="table-ban">禁言</th>
                                    <th class="table-waring">警告</th>
                                    <th class="table-date am-hide-sm-only">用户权限变更</th>
                                </tr>
                                </thead>
                                <tbody>
                                {volist name="list" id="vo"}
                                <tr>
                                    <td><input type="checkbox"></td>
                                    <td>{$vo.id}</td>
                                    <td>{$vo.name}</td>
                                    <td>男</td>
                                    <td class="am-hide-sm-only">授权时间</td>
                                    <td>
                                        <div class="am-btn-toolbar">
                                            <div class="am-btn-group am-btn-group-xs">
                                                <button
                                                    type="button" vid="{$vo.id}" value="{$vo.password}" class=" doc-prompt-toggle am-btn am-btn-default" >
                                                <span class="am-icon-pencil-square"></span>设置密码
                                                </button>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="am-hide-sm-only">
                                        <select  class="banTime" data-am-selected="{btnWidth: '80%'}" user_id="{$vo.id}">
                                            <option value="0">时间</option>
                                            <option value="1440">一天</option>
                                            <option value="4320">三天</option>
                                            <option value="43200">一个月</option>
                                            <option value="5184000">一年</option>
                                        </select>
                                    </td>
                                    <td class="am-hide-sm-only">
                                        <button type="button"  value="{$vo.id}" name="{$vo.name}" class=" warning am-btn am-btn-default am-text-warning am-btn-xs am-hide-sm-only"> <span class="am-icon-bolt"></span>警告</button>
                                    </td>
                                    <td class="am-hide-sm-only">
                                        {if condition = "$vo.viplevel eq 1"}
                                        <select class="identity" data-am-selected user_id="{$vo.id}">
                                            <option value="1" selected>超级管理员</option>
                                            <option value="2">超级编辑</option>
                                            <option value="3">小编</option>
                                            <option value="4">校圈视频侠</option>
                                            <option value="5" >解忧人</option>
                                            <option value="10" >普通用户</option>
                                        </select>
                                        {elseif condition = "$vo.viplevel eq 2"}
                                        <select class="identity"data-am-selected user_id="{$vo.id}">
                                            <option value="1">超级管理员</option>
                                            <option value="2" selected>超级编辑</option>
                                            <option value="3">小编</option>
                                            <option value="4">校圈视频侠</option>
                                            <option value="5" >解忧人</option>
                                            <option value="10" >普通用户</option>
                                        </select>
                                        {elseif condition = "$vo.viplevel eq 3"}
                                        <select class="identity" data-am-selected user_id="{$vo.id}">
                                            <option value="1">超级管理员</option>
                                            <option value="2">超级编辑</option>
                                            <option value="3" selected>小编</option>
                                            <option value="4">校圈视频侠</option>
                                            <option value="5" >解忧人</option>
                                            <option value="10" >普通用户</option>
                                        </select>
                                        {elseif condition = "$vo.viplevel eq 4"}
                                        <select class="identity"data-am-selected user_id="{$vo.id}">
                                            <option value="1">超级管理员</option>
                                            <option value="2">超级编辑</option>
                                            <option value="3" >小编</option>
                                            <option value="4" selected>校圈视频侠</option>
                                            <option value="5" >解忧人</option>
                                            <option value="10" >普通用户</option>
                                        </select>
                                        {elseif condition = "$vo.viplevel eq 5"}
                                        <select class="identity" data-am-selected user_id="{$vo.id}">
                                            <option value="1">超级管理员</option>
                                            <option value="2">超级编辑</option>
                                            <option value="3" >小编</option>
                                            <option value="4" >校圈视频侠</option>
                                            <option value="5" selected>解忧人</option>
                                            <option value="10" >普通用户</option>
                                        </select>
                                        {else /}
                                        <select  class="identity" data-am-selected user_id="{$vo.id}">
                                            <option value="1">超级管理员</option>
                                            <option value="2">超级编辑</option>
                                            <option value="3" >小编</option>
                                            <option value="4" >校圈视频侠</option>
                                            <option value="5" >解忧人</option>
                                            <option value="10" selected>普通用户</option>
                                        </select>
                                        {/if}
                                    </td>


                                </tr>
                                {/volist}

                                </tbody>
                            </table>
                            <div class="am-cf">

                                <div class="am-fr">
                                    {if condition = "$num eq 1"}

                                    {else /}
                                        {$list->render()}
                                    {/if}
                                </div>
                            </div>
                            <hr>
                        </form>
                    </div>

                </div>
            </div>
            <div class="tpl-alert"></div>
        </div>
    </div>

</div>

<div class="am-modal am-modal-prompt" tabindex="-1" id="my-prompt">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">设置密码</div>
        <div class="am-modal-bd">
            不可输入非法字符
            <input type="text" class="replayContent am-modal-prompt-input" placeholder="">
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn" data-am-modal-cancel>取消</span>
            <span class="am-modal-btn" data-am-modal-confirm>提交</span>
        </div>
    </div>
</div>


<div class="am-modal am-modal-prompt" tabindex="-1" id="warning-prompt">
    <div class="am-modal-dialog">
        <div class="am-modal-hd">发送警告</div>
        <div class="warning_people am-modal-bd ">

            <input type="text" class="warning-content am-modal-prompt-input" placeholder="">
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn" data-am-modal-cancel>取消</span>
            <span class="am-modal-btn" data-am-modal-confirm>提交</span>
        </div>
    </div>
</div>


<div class="am-modal am-modal-alert" tabindex="-1" id="my-alert">
    <div class="am-modal-dialog">
        <div class="am-modal-hd" id="alert_title">黑科Online_后台系统</div>
        <div class="am-modal-bd" id="alert">

        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn">确定</span>
        </div>
    </div>
</div>

<div class="am-modal am-modal-confirm" tabindex="-1" id="my-confirm">

    <div class="am-modal-dialog">
        <div class="am-modal-hd">危险操作</div>
        <div class="am-modal-bd">

        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn" data-am-modal-cancel>取消</span>
            <span class="am-modal-btn" data-am-modal-confirm>确定</span>
        </div>
    </div>
</div>

{include file="public/footer" /}
<script type="text/javascript">
    //搜索用户
    $('#selectIcon').click(function () {
            var url = "{:url('user/selectUser')}";
            var data ={
                user_id: $('#select').val()
            };
            if (isNaN($('#select').val())){
                $('#alert').html("哥输入id哥，没看见让输入用户id么");
                $('#my-alert').modal('open');
                return false;
            };
            if ($('#select').val()==''){
                $('#alert').html("玩呢啊");
                $('#my-alert').modal('open');
                return false;
            }
            $.post(url,data,function (res) {
                if (res.data!= 0){
                    window.location.href="/index/user/userselectlist.html?id="+res.data[0].id;
                }else{
                    $('#alert').html(res.mes);
                    $('#my-alert').modal('open');
                }
            })
    });
    //搜索用户
    $('#select').bind('keydown',function(event){
        if(event.keyCode == "13") {
            var url = "{:url('user/selectUser')}";
            var data ={
                user_id: $(this).val()
            };
            if (isNaN($(this).val())){
                $('#alert').html("哥输入id哥，没看见让输入用户id么");
                $('#my-alert').modal('open');
                return false;
            }
            if ($(this).val()==''){
                $('#alert').html("玩呢啊");
                $('#my-alert').modal('open');
                return false;
            }
            $.post(url,data,function (res) {
                if (res.data!= 0){
                    window.location.href="/index/user/userselectlist.html?id="+res.data[0].id;
                }else{
                    $('#alert').html(res.mes);
                    $('#my-alert').modal('open');
                }
            })
        }
    });
    //用户权限变更
    $('.identity').change(function () {
        var identity = $(this).find("option:selected").text();
        var viplevel = $(this).find("option:selected").val();
        var id = $(this).attr('user_id');
        var url = "{:url('user/identityChange')}";
        var data = {
            'id':id,
            'viplevel':viplevel
        };
        $('.am-modal-bd').html("您，确定要将该用户的权限变更到"+identity+"吗?");
        $('#my-confirm').modal({
            onConfirm: function(options) {
                status_change(url,data);
            },
            onCancel: function() {
                window.location.reload()
            }
        });
    })

    $('.banTime').change(function () {
        var time = $(this).find("option:selected").text();
        var minutes = $(this).find("option:selected").val();
        var user_id = $(this).attr('user_id');
        var url = "{:url('user/banTime')}";
        var data = {
            'user_id':user_id,
            'minutes':minutes
        };
        $('.am-modal-bd').html("您，确定要将该用户禁言"+time+"吗?");
        $('#my-confirm').modal({
            onConfirm: function(options) {
                status_change(url,data);
            },
            onCancel: function() {
                window.location.reload()
            }
        });
    });
    //设置密码
    $('.doc-prompt-toggle').on('click', function() {
        $('.replayContent').attr('placeholder',$(this).val());
           var id = $(this).attr('vid');
           var url = "{:url('user/changePassword')}";
           var data = {
             'id':id
           };
        $('#my-prompt').modal({
            onConfirm: function(e) {
                  data.password = e.data;
                status_change(url,data);
            }
        });
    });
    //警告
    $('.warning').click(function () {
        $('.warning_people').prepend('警告的用户是：'+$(this).attr('name'));
        var id = $(this).val();
        var url = servername.appServer+'/systemmsg.do ';
        var data = {
            'userId':id,
            'importantLevel':5
        };
        $('#warning-prompt').modal({
            onConfirm: function(e) {
                data.text = e.data;
                $.post({
                    url: servername.appServer+"/systemmsg.do ",
                    contentType:"application/json",
                    data: JSON.stringify(data),
                    success: function (result) {
                        if (result==1){
                            //重置状态a
                            $('#alert').html('警告成功');
                            $('#my-alert').modal('open');
                        } else{
                            $('#alert').html('警告失败请联系管理员');
                            $('#my-alert').modal('open')
                        }
                    },
                });
            },
            onCancel:function () {
                window.location.reload()
            }
        });
    });
    //反馈查看
    // $('.see').click(function () {
    //     $('#view').html($(this).val());
    // });
    // //发布
    // $('.release').click(function () {
    //     var id = this.value;
    //     var url = "{:url('User/release')}";
    //     var data ={
    //         'id' : id,
    //         'status':1
    //     };
    //     status_change(url,data);
    // });
    //
    // //下线
    // $('.under').click(function () {
    //     var id = this.value;
    //     var url = "{:url('User/under')}";
    //     var data ={
    //         'id' : id,
    //         'status':0
    //     };
    //     status_change(url,data);
    // });
    //
    // //删除
    // $('.del').click(function () {
    //     var id = this.value;
    //     var url = "{:url('User/del')}";
    //     var data ={
    //         'id' : id,
    //         'status':-1
    //     };
    //     status_change(url,data);
    // })

</script>
</body>

</html>